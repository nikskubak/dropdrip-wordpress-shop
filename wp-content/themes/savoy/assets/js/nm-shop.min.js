/* NM: Shop script */
(function(b){b.extend(b.nmTheme,{shop_init:function(){var a=this;a.shopSelectConfig={onOpen:function(){var a=b(this);a.closest("tr").addClass("open");var c=a.closest("tr")[0].getBoundingClientRect().width;a.children(".sod_list_wrapper").css("width",c+"px");a.children("select").trigger("focusin")},onChange:function(){b(this).closest("tr").removeClass("open")},onClose:function(){b(this).closest("tr").removeClass("open")}};if(a.isShop){a.shopAjax=!1;a.scrollOffsetDesktop=parseInt(nm_wp_vars.shopScrollOffset);
a.scrollOffsetTablet=parseInt(nm_wp_vars.shopScrollOffsetTablet);a.scrollOffsetMobile=parseInt(nm_wp_vars.shopScrollOffsetMobile);a.infloadScroll=!1;a.categoryClicked=!1;a.shopLoaderSpeed=300;a.shopScrollSpeed=410;a.$shopBrowseWrap=b("#nm-shop-browse-wrap");a.imageLazyLoading="0"!=nm_wp_vars.shopImageLazyLoad?!0:!1;a.filtersEnableAjax="0"!=nm_wp_vars.shopFiltersAjax?a.isTouch&&"1"!=nm_wp_vars.shopFiltersAjax?!1:!0:!1;a.shopSetScrollOffset();a.shopSetMinHeight();var c=null;a.$window.resize(function(){c&&
clearTimeout(c);c=setTimeout(function(){a.shopSetMinHeight();a.shopSetScrollOffset()},250)});if(a.$pageIncludes.hasClass("banner-slider"))a.$document.on("banner-slider-loaded",function(){a.shopUrlHashScroll()});else a.shopUrlHashScroll();a.imageLazyLoading&&setTimeout(function(){a.$shopWrap.addClass("images-show")},50);if(a.filtersEnableAjax)a.$window.on("popstate.nmshop",function(b){b.originalEvent.state&&b.originalEvent.state.nmShop&&a.shopGetPage(window.location.href,!0)});b("#nm-main-menu-ul").children(".shop-link").find("> a").bind("click",
function(b){b.preventDefault();a.shopScrollToTop()});a.filtersEnableAjax&&(a.$shopWrap.on("click","#nm-shop-filters-reset",function(b){b.preventDefault();b=location.href.replace(location.search,"");a.shopGetPage(b)}),a.$shopWrap.on("click","#nm-shop-search-taxonomy-reset",function(c){c.preventDefault();c=b(this);c=c.closest(".nm-shop-results-bar").hasClass("is-search")?a.urlGetParameter("s")?c.data("shop-url"):location.href.replace(location.search,""):c.data("shop-url");a.shopGetPage(c)}))}if(a.shopCustomSelect)a.$document.on("woocommerce_update_variation_values",
"#nm-variations-form",function(){b("#nm-variations-form").find("select").each(function(){b(this).selectOrDie("update")})});"undefined"!==typeof wc_add_to_cart_params&&"yes"!==wc_add_to_cart_params.cart_redirect_after_add?(a.$body.on("adding_to_cart",function(b,c,f){a.$widgetPanel.length?a.quickviewIsOpen()||a.widgetPanelShow(!0):a.$widgetPanelOverlay.addClass("nm-loader show")}),a.$body.on("added_to_cart",function(b,c,f){a.$widgetPanel.length?a.quickviewIsOpen()||a.widgetPanelCartHideLoader():a.$widgetPanelOverlay.trigger("click").removeClass("show nm-loader")})):
a.$document.off("click",".add_to_cart_button");a.shopLoadExtension()},shopLoadExtension:function(){b.nmThemeExtensions.add_to_cart&&b.nmThemeExtensions.add_to_cart.call(this);this.isShop&&(b.nmThemeExtensions.infload&&b.nmThemeExtensions.infload.call(this),b.nmThemeExtensions.filters&&b.nmThemeExtensions.filters.call(this),this.searchEnabled&&b.nmThemeExtensions.search&&b.nmThemeExtensions.search.call(this));this.$pageIncludes.hasClass("quickview")&&b.nmThemeExtensions.quickview&&b.nmThemeExtensions.quickview.call(this)},
shopUrlHashScroll:function(){"#shop"===window.location.hash&&this.shopScrollToTop(!0)},shopCheckVariationDetails:function(a){var b=a.children(),e=!0;if(b.length)for(var d=0;d<b.length;d++)if(b.eq(d).children().length){e=!1;break}e?a.hide():a.show()},shopSetScrollOffset:function(){var a=this.$body.width();this.scrollOffset=863<a?this.$header.hasClass("static-on-scroll")?this.$header.outerHeight():this.scrollOffsetDesktop:383<a?this.scrollOffsetTablet:this.scrollOffsetMobile},shopSetMinHeight:function(){var a=
b("#nm-footer").outerHeight(!0);this.$shopWrap.css("min-height",this.$window.height()-(a+this.scrollOffset)+"px")},shopScrollToTop:function(a,c){var e=0,d=399<this.$window.width()?Math.round(this.$shopWrap.offset().top-this.scrollOffset):Math.round(b("#nm-shop-products").offset().top-24-this.scrollOffset);a&&this.shopSetMinHeight();c?b("html, body").scrollTop(d):(e=this.shopScrollSpeed,b("html, body").animate({scrollTop:d},this.shopScrollSpeed));return e},shopRemoveNotices:function(){b("#nm-shop-notices-wrap").empty()},
shopShowLoader:function(a){var c=b("#nm-shop-products-overlay");a&&c.addClass("no-anim");c.addClass("show")},shopHideLoader:function(a){var c=b("#nm-shop-products-overlay");a||c.removeClass("no-anim");c.removeClass("nm-loader").addClass("fade-out");setTimeout(function(){c.removeClass("show fade-out").addClass("nm-loader")},this.shopLoaderSpeed);this.infloadScroll&&(this.infscrollLock=!1,this.$window.trigger("scroll"))},singleProductVariationsInit:function(a){var c=this,e=a.children(".variations"),
d=a.children(".single_variation_wrap").children(".single_variation");if(c.shopCustomSelect){a=e.find("select");for(var f,g=0;g<a.length;g++)f=a.eq(g),f.parent().hasClass("nm-select-hidden")||f.selectOrDie(c.shopSelectConfig)}var h=null;e.find(".nm-variation-control").children("li").bind("click",function(){if(!h){var a=b(this),c=a.parent(),d=c.parent().children(".nm-select-hidden").find("select"),e=a.data("value");c.children(".selected").removeClass("selected");a.addClass("selected");d.val(e).trigger("change");
h=setTimeout(function(){h=null},300)}});c.shopCheckVariationDetails(d);d.on("show_variation",function(){c.shopCheckVariationDetails(b(this))});d.on("hide_variation",function(){d.css("display","none")})},quickviewIsOpen:function(){return b("#nm-quickview").is(":visible")}});b.nmThemeExtensions.shop=b.nmTheme.shop_init})(jQuery);